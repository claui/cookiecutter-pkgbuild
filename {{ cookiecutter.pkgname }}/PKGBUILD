# Maintainer: {{ cookiecutter.pkgbuild_maintainer }}

pkgname={{ cookiecutter.pkgname }}
{% if cookiecutter.gitpkgname != cookiecutter.pkgname -%}
_gitpkgname={{ cookiecutter.gitpkgname }}
{% endif -%}
pkgver={{ cookiecutter.pkgver }}
pkgrel=1
pkgdesc='{{ cookiecutter.pkgdesc }}'
arch=('any')
url='https://github.com/Foo/foo'
license=('{{ cookiecutter.upstream_license }}')
# groups=()
depends=()
makedepends=()
checkdepends=()
# optdepends=('baz: Use baz for quxing')
{% if cookiecutter.is_vcs -%}
provides=("{{ cookiecutter.pkgname_no_vcs }}=${pkgver}")
conflicts=('{{ cookiecutter.pkgname_no_vcs }}')
{%- else -%}
# provides=()
# conflicts=()
{%- endif %}
# replaces=()
# backup=()
# options=('!strip')
# install="${pkgname}.install"
# changelog=

source=(
  {% if cookiecutter.is_vcs -%}
  "{{ cookiecutter.pkgname_var }}::git+https://github.com/Foo/foo.git"
  {%- else -%}
  "{{ cookiecutter.src_subdir }}.tar.gz::https://github.com/Foo/foo/archive/v${pkgver}.tar.gz"
  {%- endif %}
)

sha512sums=(
  '{% if cookiecutter.is_vcs %}SKIP{%- else -%}00000000001{%- endif %}'
)

# noextract=("{{ cookiecutter.src_subdir }}.tar.gz")

{% if cookiecutter.is_vcs -%}
pkgver() {
  printf "r%s.%s" \
    "$(git -C "{{ cookiecutter.src_subdir }}" rev-list --count HEAD)" \
    "$(git -C "{{ cookiecutter.src_subdir }}" rev-parse --short HEAD)"
}

{% endif -%}
prepare() {
  cd "{{ cookiecutter.src_subdir }}"

}

build() {
  cd "{{ cookiecutter.src_subdir }}"

}

check() {
  cd "{{ cookiecutter.src_subdir }}"

}

package() {
  cd "{{ cookiecutter.src_subdir }}"

  echo >&2 'Packaging the executable'
  install -D -m 755 -t "${pkgdir}/usr/bin" "bin/{{ cookiecutter.pkgname_var }}"

  echo >&2 'Packaging the README'
  install -D -m 644 -t "${pkgdir}/usr/share/doc/${pkgname}" \
    'README.md'

  echo >&2 'Packaging the license'
  install -D -m 644 -t "${pkgdir}/usr/share/licenses/${pkgname}" \
    'LICENSE'
}
